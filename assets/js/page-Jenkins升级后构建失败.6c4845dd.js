(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{798:function(s,a,t){"use strict";t.r(a);var n=t(1),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"jenkins升级后构建失败"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins升级后构建失败"}},[s._v("#")]),s._v(" Jenkins升级后构建失败")]),s._v(" "),t("h2",{attrs:{id:"jenkins升级"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins升级"}},[s._v("#")]),s._v(" Jenkins升级")]),s._v(" "),t("p",[s._v("因项目需要，需将"),t("code",[s._v("Jenkins")]),s._v("进行升级，以满足后序需求。升级过程忽略。")]),s._v(" "),t("blockquote",[t("p",[s._v("升级前：Jenkins 2.208")]),s._v(" "),t("p",[s._v("升级后：Jenkins 2.314")])]),s._v(" "),t("h2",{attrs:{id:"jenkins-打包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-打包"}},[s._v("#")]),s._v(" Jenkins 打包")]),s._v(" "),t("p",[s._v("使用新升级的Jenkins进行打包之后，出现了错误信息。（敏感信息使用 "),t("code",[s._v("**")]),s._v(" 代替）")]),s._v(" "),t("blockquote",[t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ------------------------------------------------------------------------\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" BUILD FAILURE\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ------------------------------------------------------------------------\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Total time:  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.032")]),s._v(" s\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Finished at: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-10-08T16:45:25+08:00\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ------------------------------------------------------------------------\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.8.1:compile "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default-compile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" on project **: Compilation failure\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" No compiler is provided "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" this environment. Perhaps you are running on a JRE rather than a JDK?\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Help "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" To see the full stack trace of the errors, re-run Maven with the -e switch.\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Re-run Maven using the -X switch to "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" full debug logging.\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" For "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" information about the errors and possible solutions, please "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" the following articles:\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Help "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" After correcting the problems, you can resume the build with the "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   mvn "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("goals"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -rf :lumi_new_retail_base\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 Build step "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Invoke top-level Maven targets'")]),s._v(" marked build as failure\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 Finished: FAILURE\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])])]),s._v(" "),t("h2",{attrs:{id:"错误分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#错误分析"}},[s._v("#")]),s._v(" 错误分析")]),s._v(" "),t("h3",{attrs:{id:"升级之前"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#升级之前"}},[s._v("#")]),s._v(" 升级之前")]),s._v(" "),t("p",[s._v("在升级之前，也就是使用老版本时，项目构建均正常，无报错情况。")]),s._v(" "),t("h3",{attrs:{id:"升级之后"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#升级之后"}},[s._v("#")]),s._v(" 升级之后")]),s._v(" "),t("p",[s._v("升级之后，项目构建异常，构建异常：")]),s._v(" "),t("blockquote",[t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.8.1:compile "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default-compile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" on project **: Compilation failure\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45:25 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" No compiler is provided "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" this environment. Perhaps you are running on a JRE rather than a JDK?\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])]),s._v(" "),t("p",[s._v("从错误上看，应该有分为两个错误，一个时Maven组件错误，另一个是JDK的错误。")]),s._v(" "),t("h4",{attrs:{id:"maven-版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#maven-版本"}},[s._v("#")]),s._v(" Maven 版本")]),s._v(" "),t("p",[s._v("根据错误分析，为"),t("code",[s._v("Maven")]),s._v("组件"),t("code",[s._v("3.8.1")]),s._v("版本加载错误。")]),s._v(" "),t("p",[s._v("排查流程：")]),s._v(" "),t("p",[s._v("1、查找之前老版本使用的"),t("code",[s._v("Maven")]),s._v("版本")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@lumi jenkins"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#mvn -version")]),s._v("\nApache Maven "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.6")]),s._v(".1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("d66c9c0b3152b2e69ee9bac180bb8fcc8e6af555"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-04-05T03:00:29+08:00"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nMaven home: /usr/local/maven/apache-maven-3.6.1\nJava version: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.8")]),s._v(".0_181, vendor: Oracle Corporation, runtime: /usr/lib/java/jdk1.8.0_181/jre\nDefault locale: zh_CN, platform encoding: UTF-8\nOS name: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linux"')]),s._v(", version: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.10.0-1062.9.1.el7.x86_64"')]),s._v(", arch: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"amd64"')]),s._v(", family: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unix"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("根据上述信息可以查看，"),t("code",[s._v("Maven")]),s._v("使用的版本是"),t("code",[s._v("3.6.1")]),s._v("，使用的"),t("code",[s._v("JDK")]),s._v("版本是"),t("code",[s._v("jdk1.8.0_181")]),s._v("。")]),s._v(" "),t("p",[s._v("2、根据"),t("code",[s._v("Maven")]),s._v("版本排查")]),s._v(" "),t("p",[t("code",[s._v("Maven")]),s._v("版本排查，为"),t("code",[s._v("Maven")]),s._v("版本的问题，那么为什么"),t("code",[s._v("Jenkins")]),s._v("没能找到"),t("code",[s._v("3.6.1")]),s._v("，而是找到了"),t("code",[s._v("3.8.1")]),s._v("呢？")]),s._v(" "),t("p",[s._v("3、查看"),t("code",[s._v("Jenkins")]),s._v("配置："),t("code",[s._v("Dashboard > 系统管理 > 全局工具配置 > Maven")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/AbnerMai/AbnerMaiBlog/master/images/blogImages/202110091038451.png",alt:"image-20211008174727990"}})]),s._v(" "),t("p",[s._v("4、问题发现：根据最新的"),t("code",[s._v("Jenkins")]),s._v("，即为"),t("code",[s._v("2.314")]),s._v("版本，默认使用的"),t("code",[s._v("Maven")]),s._v("为"),t("code",[s._v("3.8.1")]),s._v("，因为没有配置，而导致编译失败。")]),s._v(" "),t("p",[s._v("5、问题解决，将原来的"),t("code",[s._v("Maven")]),s._v("配置进去，并配置"),t("code",[s._v("Maven")]),s._v("的"),t("code",[s._v("Settings.xml")]),s._v("文件")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/AbnerMai/AbnerMaiBlog/master/images/blogImages/202110091038097.png",alt:"image-20211008175134102"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/AbnerMai/AbnerMaiBlog/master/images/blogImages/202110091038081.png",alt:"image-20211008175145990"}})]),s._v(" "),t("h4",{attrs:{id:"jdk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jdk"}},[s._v("#")]),s._v(" JDK")]),s._v(" "),t("p",[t("code",[s._v("Maven")]),s._v("配置好之后，构建仍然存在问题，根据排查"),t("code",[s._v("Maven")]),s._v("的步骤排查"),t("code",[s._v("JDK")]),s._v("。")]),s._v(" "),t("p",[s._v("在"),t("code",[s._v("Jenkins")]),s._v("中的配置查看"),t("code",[s._v("JDK")]),s._v("的配置情况，发现"),t("code",[s._v("JDK")]),s._v("并未配置：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/AbnerMai/AbnerMaiBlog/master/images/blogImages/202110091038172.png",alt:"image-20211008175524179"}})]),s._v(" "),t("p",[s._v("我们将其配置上，配置本地存在的jdk版本：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/AbnerMai/AbnerMaiBlog/master/images/blogImages/202110091039280.png",alt:"image-20211008175554013"}})]),s._v(" "),t("p",[s._v("构建项目，发现成功了。")]),s._v(" "),t("h2",{attrs:{id:"总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),t("p",[s._v("不管是什么的升级，在进行升级操作之后，要检查一下配置情况，并且要验证一次升级成功。")]),s._v(" "),t("p",[s._v("如果升级之后的软件，需要兼容新老应用，在升级之后，需使用老应用进行至少一次验证，并且保证老应用在新的版本下运行无异常。")])])}),[],!1,null,null,null);a.default=e.exports}}]);